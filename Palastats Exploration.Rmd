---
title: "Palastats"
output: html_document
---

```{r message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)

df_wide <- read_csv('D:/Projects/Paladins/Palastats/AllData_Final.csv')

g1 <- gg_color_hue <- function(n) {
     hues = seq(15, 375, length = n + 1)
     hcl(h = hues, l = 65, c = 100)[1:n]
 }
```

```{r message=FALSE, warning=FALSE, include=FALSE}
match_df <- df_wide %>% 
  select(id, map, outcome, fixed_time, team, gametype,
         healing, damage, kills, deaths, assists) 
match_df$deaths[is.na(match_df$deaths)] <- 0
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
match_df %>% 
  select(outcome, id, team, deaths, gametype) %>% 
  group_by(outcome, id, team, gametype) %>% 
  summarise_all(funs(sum)) %>% 
  spread(team, deaths) %>% 
  ungroup(outcome, gametype) %>% 
  filter(blue < 100) %>% 
  mutate(outcome = ifelse(outcome=='VICTORY', 'Blue Win', 'Red Win')) %>% 
  ggplot(aes(x=red, y=blue, colour=outcome)) +
  geom_point(size=2) +
  geom_abline(intercept=0) +
  xlab('Red Team Deaths') +
  ylab('Blue Team Deaths')  +
  #theme_minimal() +
  theme(
    legend.title = element_blank(),
    legend.position = 'top',
    axis.text.x = element_text(colour='#F8766D', face='bold'),
    axis.title.x = element_text(colour='#F8766D', face='bold'),
    axis.text.y = element_text(colour='#00BFC4', face='bold'),
    axis.title.y = element_text(colour='#00BFC4', face='bold')
  ) +
  scale_color_manual(values = rev(gg_color_hue(2))) +
  #ggtitle('Dead teams lose games') +
  facet_grid(.~gametype) +
  ggtitle('Dead teams lose games')
```

```{r message=FALSE, warning=FALSE, include=FALSE}
ggsave('D:/Projects/Paladins/Palastats/example/graph1.png', width = 3, height = 3, units='in')
```


```{r echo=FALSE, message=FALSE, warning=FALSE}
match_df %>% 
  select(outcome, id, team, deaths, gametype,
         fixed_time) %>% 
  group_by(outcome, id, team, gametype, fixed_time) %>% 
  summarise_all(funs(sum)) %>% 
  spread(team, deaths) %>% 
  ungroup(outcome, gametype) %>% 
  mutate(diff_deaths = blue - red) %>%  
  filter(blue < 100) %>% 
  mutate(outcome = ifelse(outcome=='VICTORY', 'Blue Win', 'Red Win')) %>% 
  ggplot(aes(x=fixed_time, y=diff_deaths, colour=outcome)) +
  geom_point(size=2) +
  geom_abline(intercept=0) +
  xlab('Match Duration') +
  ylab('Blue deaths Minus Red deaths')  +
  #theme_minimal() +
  theme(
    legend.title = element_blank(),
    title = element_text(size=4),
    legend.position = 'top',
    axis.text.x = element_text(size = 6,  face='bold'),
    #axis.title.x = element_text(colour='#F8766D', face='bold'),
    axis.text.y = element_text(size = 6,  face='bold')
    #axis.title.y = element_text(colour='#00BFC4', face='bold')
  ) +
  scale_color_manual(values = rev(gg_color_hue(2))) +
  ggtitle("Deathmatch is shorter than Siege unless somebody's getting rolled") +
  facet_grid(.~gametype) + 
  geom_hline(yintercept=0)
```


```{r message=FALSE, warning=FALSE, include=FALSE}
ggsave('D:/Projects/Paladins/Palastats/example/graph2.png', width = 3, height = 3, units='in')
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
match_df %>% 
  select(outcome, id, team, damage, gametype,
         fixed_time) %>% 
  group_by(outcome, id, team, gametype, fixed_time) %>% 
  summarise_all(funs(sum)) %>% 
  spread(team, damage) %>% 
  ungroup(outcome, gametype) %>% 
  mutate(diff_damage = blue - red) %>%  
  filter(diff_damage > -400000) %>% 
  mutate(outcome = ifelse(outcome=='VICTORY', 'Blue Win', 'Red Win')) %>% 
  ggplot(aes(x=fixed_time, y=diff_damage, colour=outcome)) +
  geom_point(size=2) +
  xlab('Match Duration') +
  ylab('Blue damage Minus Red damage')  +
  #theme_minimal() +
  theme(
    legend.title = element_blank(),
    #title = element_text(size=4),
    legend.position = 'top'
    #axis.text.x = element_text(size = 6,  face='bold'),
    #axis.title.x = element_text(colour='#F8766D', face='bold'),
    #axis.text.y = element_text(size = 6,  face='bold')
    #axis.title.y = element_text(colour='#00BFC4', face='bold')
  ) +
  scale_color_manual(values = rev(gg_color_hue(2))) +
  #ggtitle("Deathmatch is shorter than Siege unless somebody's getting rolled") +
  facet_grid(.~gametype) + 
  geom_hline(yintercept=0)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}
match_df %>% 
  select(outcome, id, team, healing, gametype,
         fixed_time) %>% 
  group_by(outcome, id, team, gametype, fixed_time) %>% 
  summarise_all(funs(sum)) %>% 
  spread(team, healing) %>% 
  ungroup(outcome, gametype) %>% 
  mutate(diff_healing = blue - red) %>%  
  filter(diff_healing > -400000) %>% 
  mutate(outcome = ifelse(outcome=='VICTORY', 'Blue Win', 'Red Win')) %>% 
  ggplot(aes(x=fixed_time, y=diff_healing, colour=outcome)) +
  geom_point(size=2) +
  xlab('Match Duration') +
  ylab('Blue healing Minus Red healing')  +
  #theme_minimal() +
  theme(
    legend.title = element_blank(),
    #title = element_text(size=4),
    legend.position = 'top'
    #axis.text.x = element_text(size = 6,  face='bold'),
    #axis.title.x = element_text(colour='#F8766D', face='bold'),
    #axis.text.y = element_text(size = 6,  face='bold')
    #axis.title.y = element_text(colour='#00BFC4', face='bold')
  ) +
  scale_color_manual(values = rev(gg_color_hue(2))) +
  #ggtitle("Deathmatch is shorter than Siege unless somebody's getting rolled") +
  facet_grid(.~gametype) + 
  geom_hline(yintercept=0)
```

